Traceback (most recent call last):
  File "/usr/share/miniconda3/envs/main-conda-env/lib/python3.8/site-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/usr/share/miniconda3/envs/main-conda-env/lib/python3.8/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/usr/share/miniconda3/envs/main-conda-env/lib/python3.8/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/usr/share/miniconda3/envs/main-conda-env/lib/python3.8/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/usr/share/miniconda3/envs/main-conda-env/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/usr/share/miniconda3/envs/main-conda-env/lib/python3.8/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/usr/share/miniconda3/envs/main-conda-env/lib/python3.8/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/usr/share/miniconda3/envs/main-conda-env/lib/python3.8/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# Solve the optimisation problem using the scipy.optimize.minimize function.

# There are various methods that can be used in the scipy.optimize.minize function.
# These methods are listed below.

methods = ['Nelder-Mead',     # also known as Downhill Simplex, Amoeba or Polytope
           'Powell',
           'CG',              # Conjugate Gradient
           'BFGS',            # Broydenâ€“Fletcherâ€“Goldfarbâ€“Shanno (quasi-Newton method)
           'Newton-CG',       # Newton Conjugate Gradient (Newton method)
           'L-BFGS-B',        # Limited-memory BFGS (quasi-Newton method)
           'TNC',             # Truncated Newton (quasi-Newton method)
           'COBYLA',          # Constrained Optimization BY Linear Approximation
           'SLSQP',           # Sequential Least Squares Programming 
           'trust-constr',    # Trust-Region Constrained
           'dogleg',          # Trust-Region dogleg
           'trust-ncg',       # Trust-Region Newton Conjugate Gradient
           'trust-krylov',    # Trust-Region Truncated Generalized Lanczos
           'trust-exact']     # Trust-Region Nearly Exact

method = methods[8]

solution = minimize(objective,initial_quantities,
                    method = method,
                    bounds = bounds,
                    constraints = constraints)
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mValueError[0m                                Traceback (most recent call last)
Input [0;32mIn [13][0m, in [0;36m<cell line: 23>[0;34m()[0m
[1;32m      6[0m methods [38;5;241m=[39m [[38;5;124m'[39m[38;5;124mNelder-Mead[39m[38;5;124m'[39m,     [38;5;66;03m# also known as Downhill Simplex, Amoeba or Polytope[39;00m
[1;32m      7[0m            [38;5;124m'[39m[38;5;124mPowell[39m[38;5;124m'[39m,
[1;32m      8[0m            [38;5;124m'[39m[38;5;124mCG[39m[38;5;124m'[39m,              [38;5;66;03m# Conjugate Gradient[39;00m
[0;32m   (...)[0m
[1;32m     18[0m            [38;5;124m'[39m[38;5;124mtrust-krylov[39m[38;5;124m'[39m,    [38;5;66;03m# Trust-Region Truncated Generalized Lanczos[39;00m
[1;32m     19[0m            [38;5;124m'[39m[38;5;124mtrust-exact[39m[38;5;124m'[39m]     [38;5;66;03m# Trust-Region Nearly Exact[39;00m
[1;32m     21[0m method [38;5;241m=[39m methods[[38;5;241m8[39m]
[0;32m---> 23[0m solution [38;5;241m=[39m [43mminimize[49m[43m([49m[43mobjective[49m[43m,[49m[43minitial_quantities[49m[43m,[49m
[1;32m     24[0m [43m                    [49m[43mmethod[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[43mmethod[49m[43m,[49m
[1;32m     25[0m [43m                    [49m[43mbounds[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[43mbounds[49m[43m,[49m
[1;32m     26[0m [43m                    [49m[43mconstraints[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[43mconstraints[49m[43m)[49m

File [0;32m/usr/share/miniconda3/envs/main-conda-env/lib/python3.8/site-packages/scipy/optimize/_minimize.py:684[0m, in [0;36mminimize[0;34m(fun, x0, args, method, jac, hess, hessp, bounds, constraints, tol, callback, options)[0m
[1;32m    680[0m                 [38;5;28;01mif[39;00m callable(con[38;5;241m.[39mget([38;5;124m'[39m[38;5;124mjac[39m[38;5;124m'[39m, [38;5;28;01mNone[39;00m)):
[1;32m    681[0m                     con[[38;5;124m'[39m[38;5;124mjac[39m[38;5;124m'[39m] [38;5;241m=[39m _remove_from_func(con[[38;5;124m'[39m[38;5;124mjac[39m[38;5;124m'[39m], i_fixed,
[1;32m    682[0m                                                    x_fixed, min_dim[38;5;241m=[39m[38;5;241m2[39m,
[1;32m    683[0m                                                    remove[38;5;241m=[39m[38;5;241m1[39m)
[0;32m--> 684[0m     bounds [38;5;241m=[39m [43mstandardize_bounds[49m[43m([49m[43mbounds[49m[43m,[49m[43m [49m[43mx0[49m[43m,[49m[43m [49m[43mmeth[49m[43m)[49m
[1;32m    686[0m [38;5;28;01mif[39;00m meth [38;5;241m==[39m [38;5;124m'[39m[38;5;124mnelder-mead[39m[38;5;124m'[39m:
[1;32m    687[0m     res [38;5;241m=[39m _minimize_neldermead(fun, x0, args, callback, bounds[38;5;241m=[39mbounds,
[1;32m    688[0m                                [38;5;241m*[39m[38;5;241m*[39moptions)

File [0;32m/usr/share/miniconda3/envs/main-conda-env/lib/python3.8/site-packages/scipy/optimize/_minimize.py:947[0m, in [0;36mstandardize_bounds[0;34m(bounds, x0, meth)[0m
[1;32m    945[0m [38;5;28;01melif[39;00m meth [38;5;129;01min[39;00m ([38;5;124m'[39m[38;5;124ml-bfgs-b[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mtnc[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mslsqp[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mold[39m[38;5;124m'[39m):
[1;32m    946[0m     [38;5;28;01mif[39;00m [38;5;28misinstance[39m(bounds, Bounds):
[0;32m--> 947[0m         bounds [38;5;241m=[39m [43mnew_bounds_to_old[49m[43m([49m[43mbounds[49m[38;5;241;43m.[39;49m[43mlb[49m[43m,[49m[43m [49m[43mbounds[49m[38;5;241;43m.[39;49m[43mub[49m[43m,[49m[43m [49m[43mx0[49m[38;5;241;43m.[39;49m[43mshape[49m[43m[[49m[38;5;241;43m0[39;49m[43m][49m[43m)[49m
[1;32m    948[0m [38;5;28;01mreturn[39;00m bounds

File [0;32m/usr/share/miniconda3/envs/main-conda-env/lib/python3.8/site-packages/scipy/optimize/_constraints.py:397[0m, in [0;36mnew_bounds_to_old[0;34m(lb, ub, n)[0m
[1;32m    388[0m [38;5;28;01mdef[39;00m [38;5;21mnew_bounds_to_old[39m(lb, ub, n):
[1;32m    389[0m     [38;5;124;03m"""Convert the new bounds representation to the old one.[39;00m
[1;32m    390[0m 
[1;32m    391[0m [38;5;124;03m    The new representation is a tuple (lb, ub) and the old one is a list[39;00m
[0;32m   (...)[0m
[1;32m    395[0m [38;5;124;03m    None.[39;00m
[1;32m    396[0m [38;5;124;03m    """[39;00m
[0;32m--> 397[0m     lb [38;5;241m=[39m [43mnp[49m[38;5;241;43m.[39;49m[43mbroadcast_to[49m[43m([49m[43mlb[49m[43m,[49m[43m [49m[43mn[49m[43m)[49m
[1;32m    398[0m     ub [38;5;241m=[39m np[38;5;241m.[39mbroadcast_to(ub, n)
[1;32m    400[0m     lb [38;5;241m=[39m [[38;5;28mfloat[39m(x) [38;5;28;01mif[39;00m x [38;5;241m>[39m [38;5;241m-[39mnp[38;5;241m.[39minf [38;5;28;01melse[39;00m [38;5;28;01mNone[39;00m [38;5;28;01mfor[39;00m x [38;5;129;01min[39;00m lb]

File [0;32m<__array_function__ internals>:180[0m, in [0;36mbroadcast_to[0;34m(*args, **kwargs)[0m

File [0;32m/usr/share/miniconda3/envs/main-conda-env/lib/python3.8/site-packages/numpy/lib/stride_tricks.py:412[0m, in [0;36mbroadcast_to[0;34m(array, shape, subok)[0m
[1;32m    366[0m [38;5;129m@array_function_dispatch[39m(_broadcast_to_dispatcher, module[38;5;241m=[39m[38;5;124m'[39m[38;5;124mnumpy[39m[38;5;124m'[39m)
[1;32m    367[0m [38;5;28;01mdef[39;00m [38;5;21mbroadcast_to[39m(array, shape, subok[38;5;241m=[39m[38;5;28;01mFalse[39;00m):
[1;32m    368[0m     [38;5;124;03m"""Broadcast an array to a new shape.[39;00m
[1;32m    369[0m 
[1;32m    370[0m [38;5;124;03m    Parameters[39;00m
[0;32m   (...)[0m
[1;32m    410[0m [38;5;124;03m           [1, 2, 3]])[39;00m
[1;32m    411[0m [38;5;124;03m    """[39;00m
[0;32m--> 412[0m     [38;5;28;01mreturn[39;00m [43m_broadcast_to[49m[43m([49m[43marray[49m[43m,[49m[43m [49m[43mshape[49m[43m,[49m[43m [49m[43msubok[49m[38;5;241;43m=[39;49m[43msubok[49m[43m,[49m[43m [49m[43mreadonly[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m)[49m

File [0;32m/usr/share/miniconda3/envs/main-conda-env/lib/python3.8/site-packages/numpy/lib/stride_tricks.py:348[0m, in [0;36m_broadcast_to[0;34m(array, shape, subok, readonly)[0m
[1;32m    345[0m     [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m([38;5;124m'[39m[38;5;124mall elements of broadcast shape must be non-[39m[38;5;124m'[39m
[1;32m    346[0m                      [38;5;124m'[39m[38;5;124mnegative[39m[38;5;124m'[39m)
[1;32m    347[0m extras [38;5;241m=[39m []
[0;32m--> 348[0m it [38;5;241m=[39m [43mnp[49m[38;5;241;43m.[39;49m[43mnditer[49m[43m([49m
[1;32m    349[0m [43m    [49m[43m([49m[43marray[49m[43m,[49m[43m)[49m[43m,[49m[43m [49m[43mflags[49m[38;5;241;43m=[39;49m[43m[[49m[38;5;124;43m'[39;49m[38;5;124;43mmulti_index[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[38;5;124;43m'[39;49m[38;5;124;43mrefs_ok[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[38;5;124;43m'[39;49m[38;5;124;43mzerosize_ok[39;49m[38;5;124;43m'[39;49m[43m][49m[43m [49m[38;5;241;43m+[39;49m[43m [49m[43mextras[49m[43m,[49m
[1;32m    350[0m [43m    [49m[43mop_flags[49m[38;5;241;43m=[39;49m[43m[[49m[38;5;124;43m'[39;49m[38;5;124;43mreadonly[39;49m[38;5;124;43m'[39;49m[43m][49m[43m,[49m[43m [49m[43mitershape[49m[38;5;241;43m=[39;49m[43mshape[49m[43m,[49m[43m [49m[43morder[49m[38;5;241;43m=[39;49m[38;5;124;43m'[39;49m[38;5;124;43mC[39;49m[38;5;124;43m'[39;49m[43m)[49m
[1;32m    351[0m [38;5;28;01mwith[39;00m it:
[1;32m    352[0m     [38;5;66;03m# never really has writebackifcopy semantics[39;00m
[1;32m    353[0m     broadcast [38;5;241m=[39m it[38;5;241m.[39mitviews[[38;5;241m0[39m]

[0;31mValueError[0m: operands could not be broadcast together with remapped shapes [original->remapped]: (12,)  and requested shape (3,)
ValueError: operands could not be broadcast together with remapped shapes [original->remapped]: (12,)  and requested shape (3,)

