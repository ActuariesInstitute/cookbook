
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Py: Neural Net Classification &#8212; Actuaries&#39; Analytical Cookbook</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Py: Classifying review sentiment" href="DAA_M07_CS1.html" />
    <link rel="prev" title="Py: Decision Tree Classification" href="DAA_M05_Ex10.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/actuaries-logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Actuaries' Analytical Cookbook</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction to Python
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="about_py.html">
   About Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="getting_started.html">
   Setting up Your Python Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="python_by_example.html">
   An Introductory Example
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="learn_more.html">
   Learn More
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Useful_Python_packages.html">
   Useful Python packages for Data Science
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction to R
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="about_R.html">
   About R
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="getting_started_R.html">
   Setting Up R
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="introductory_R.html">
   Introduction to R
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="intermediate_R.html">
   Next Steps With R
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="top_ten_r_packages.html">
   Useful Packages
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MLRWP_R_DataTable.html">
   R: data.table for actuaries
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Workflow Management
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="version_control.html">
   Version control
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Regression, Classification and Technical Price
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="DAA_M05_CS1.html">
   Py: Customer Churn Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multitasking_risk_pricing.html">
   Py/R: Multitasking Risk Pricing Using Deep Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="py_shap_values.html">
   Py: Explainable Models with SHAP
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Life Insurance
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="LifeRecipeBook.html">
   R: Life Modelling Recipes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="life_stats.html">
   R: Life Industry Stats in Tableau and R
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  General Insurance
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="MLRWP_R_GLMs.html">
   R: Reserving with GLMs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MLRWP_R_Lasso.html">
   R: Reserving with LASSO
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MLRWP_R_mlr3.html">
   R: Machine Learning Triangles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MLRWP_Py_triangles_example.html">
   Py: Machine Learning Triangles
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Unsupervised Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="DAA_M06_CS1.html">
   Py: Socio-Economic Index Construction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="DAA_M06_CS2.html">
   Py: Clustering Credit Card Fraud
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="DAA_M06_Ex4.html">
   Py: K-means clustering of COVID dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="DAA_M06_Ex5.html">
   Py: Hierarchical clustering on COVID dataset
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Natural Language Processing
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="R_case_study_word_cloud.html">
   R: Word Cloud Case Study
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="textClassificationEntry.html">
   Py: Text Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="DAA_M05_Ex10.html">
   Py: Decision Tree Classification
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Py: Neural Net Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="DAA_M07_CS1.html">
   Py: Classifying review sentiment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="DAA_M07_CS2.html">
   Py: Customer Sentiment Analysis
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Business Optimization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="DAA_2021_S2_Tutorial10_exercise_scipy.html">
   Py: Linear Programming
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Image Recognition
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="DAA_M05_CS2.html">
   Py: Image Recognition
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data Ethics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="automated_decision.html">
   Automated Decision-Making Systems
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contributing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="contributing.html">
   Contributing
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/docs/DAA_M05_Ex18.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/ActuariesInstitute/cookbook"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        <a class="edit-button" href="https://github.com/ActuariesInstitute/cookbook/edit/main/cookbook/docs/DAA_M05_Ex18.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/ActuariesInstitute/cookbook/main?urlpath=tree/cookbook/docs/DAA_M05_Ex18.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/ActuariesInstitute/cookbook/blob/main/cookbook/docs/DAA_M05_Ex18.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#purpose">
   Purpose:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#packages">
   Packages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data">
   Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-data">
     Import data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#explore-data-eda">
     Explore data (EDA)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modelling">
   Modelling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fit-model">
     Fit model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#evaluate-model">
     Evaluate model
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Py: Neural Net Classification</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#purpose">
   Purpose:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#packages">
   Packages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data">
   Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-data">
     Import data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#explore-data-eda">
     Explore data (EDA)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modelling">
   Modelling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fit-model">
     Fit model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#evaluate-model">
     Evaluate model
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="py-neural-net-classification">
<h1>Py: Neural Net Classification<a class="headerlink" href="#py-neural-net-classification" title="Permalink to this headline">¶</a></h1>
<p><strong>This notebook was originally created by Hugh Miller  for the Data Analytics Applications subject, as <em>Exercise 5.18 - Spam detection with a neural network</em> in the <em>DAA M05 Classification and neural networks</em> module.</strong></p>
<p><strong>Data Analytics Applications is a Fellowship Applications (Module 3) subject with the Actuaries Institute that aims to teach students how to apply a range of data analytics skills, such as neural networks, natural language processing, unsupervised learning and optimisation techniques, together with their professional judgement, to solve a variety of complex and challenging business problems. The business problems used as examples in this subject are drawn from a wide range of industries.</strong></p>
<p><strong>Find out more about the course <a class="reference external" href="https://www.actuaries.asn.au/education-program/fellowship/subjects-and-syllabus/data-analytics-applications-subject">here</a>.</strong></p>
<div class="section" id="purpose">
<h2>Purpose:<a class="headerlink" href="#purpose" title="Permalink to this headline">¶</a></h2>
<p>This notebook fits a neural network on a spam dataset to identify spam emails based on features about the email.</p>
</div>
<div class="section" id="references">
<h2>References:<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>The spam dataset is sourced from the University of California, Irvine Machine Learning Repository:   Hopkins, M., Reeber, E., Forman, G., and Suermondt, J. (1999). Spambase Data Set [Dataset]. <a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/Spambase">https://archive.ics.uci.edu/ml/datasets/Spambase</a>.</p>
<p>This dataset contains the following:</p>
<ul class="simple">
<li><p>4,601 observations, each representing an email originally collected from a Hewlett-Packard email server, of which 1,813 (39%) were identified as spam;</p></li>
<li><p>57 continuous features:</p>
<ul>
<li><p>48 features of type ‘word_freq_WORD’ that represent the percentage (0 to 100) of words in the email that match ‘WORD’;</p></li>
<li><p>6 features of type ‘char_freq_CHAR’ that represent the percentage (0 to 100) of characters in the email that match ‘CHAR’;</p></li>
<li><p>1 feature, ‘capital_run_length_average’, that is the average length of uninterrupted sequences of capital letters in the email;</p></li>
<li><p>1 feature, ‘capital_run_length_longest’, that is the length of the longest uninterrupted sequence of capital letters in the email; and</p></li>
<li><p>1 feature, ‘capital_run_length_total’, that is the total number of capital letters in the email; and</p></li>
</ul>
</li>
<li><p>a binary response variable that takes on a value 0 if the email is not spam and 1 if the email is spam.</p></li>
</ul>
</div>
<div class="section" id="packages">
<h2>Packages<a class="headerlink" href="#packages" title="Permalink to this headline">¶</a></h2>
<p>This section imports the packages that will be required for this exercise/case study.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Used to build the neural network and evaluate it.</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="data">
<h2>Data<a class="headerlink" href="#data" title="Permalink to this headline">¶</a></h2>
<p>This section:</p>
<ul class="simple">
<li><p>imports the data that will be used in the modelling; and</p></li>
<li><p>explores the data.</p></li>
</ul>
<div class="section" id="import-data">
<h3>Import data<a class="headerlink" href="#import-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a list of headings for the data.</span>
<span class="n">namearray</span> <span class="o">=</span> <span class="p">[</span>
<span class="s1">&#39;word_freq_make&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_address&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_all&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_3d&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_our&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_over&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_remove&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_internet&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_order&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_mail&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_receive&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_will&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_people&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_report&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_addresses&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_free&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_business&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_email&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_you&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_credit&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_your&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_font&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_000&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_money&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_hp&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_hpl&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_george&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_650&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_lab&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_labs&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_telnet&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_857&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_data&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_415&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_85&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_technology&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_1999&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_parts&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_pm&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_direct&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_cs&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_meeting&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_original&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_project&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_re&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_edu&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_table&#39;</span><span class="p">,</span>
<span class="s1">&#39;word_freq_conference&#39;</span><span class="p">,</span>
<span class="s1">&#39;char_freq_;&#39;</span><span class="p">,</span>
<span class="s1">&#39;char_freq_(&#39;</span><span class="p">,</span>
<span class="s1">&#39;char_freq_[&#39;</span><span class="p">,</span>
<span class="s1">&#39;char_freq_!&#39;</span><span class="p">,</span>
<span class="s1">&#39;char_freq_$&#39;</span><span class="p">,</span>
<span class="s1">&#39;char_freq_#&#39;</span><span class="p">,</span>
<span class="s1">&#39;capital_run_length_average&#39;</span><span class="p">,</span>
<span class="s1">&#39;capital_run_length_longest&#39;</span><span class="p">,</span>
<span class="s1">&#39;capital_run_length_total&#39;</span><span class="p">,</span>
<span class="s1">&#39;Spam_fl&#39;</span> <span class="p">]</span>

<span class="c1"># Read in the data from the Stanford website.</span>
<span class="n">spam</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;http://www.web.stanford.edu/~hastie/ElemStatLearn/datasets/spam.data&quot;</span><span class="p">,</span> <span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                   <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">names</span><span class="o">=</span><span class="n">namearray</span>
                 <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="explore-data-eda">
<h3>Explore data (EDA)<a class="headerlink" href="#explore-data-eda" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the dimensions of the data.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spam</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>

<span class="c1"># Print the first 10 observations from the data.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spam</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 4601 entries, 0 to 4600
Data columns (total 58 columns):
 #   Column                      Non-Null Count  Dtype  
---  ------                      --------------  -----  
 0   word_freq_make              4601 non-null   float64
 1   word_freq_address           4601 non-null   float64
 2   word_freq_all               4601 non-null   float64
 3   word_freq_3d                4601 non-null   float64
 4   word_freq_our               4601 non-null   float64
 5   word_freq_over              4601 non-null   float64
 6   word_freq_remove            4601 non-null   float64
 7   word_freq_internet          4601 non-null   float64
 8   word_freq_order             4601 non-null   float64
 9   word_freq_mail              4601 non-null   float64
 10  word_freq_receive           4601 non-null   float64
 11  word_freq_will              4601 non-null   float64
 12  word_freq_people            4601 non-null   float64
 13  word_freq_report            4601 non-null   float64
 14  word_freq_addresses         4601 non-null   float64
 15  word_freq_free              4601 non-null   float64
 16  word_freq_business          4601 non-null   float64
 17  word_freq_email             4601 non-null   float64
 18  word_freq_you               4601 non-null   float64
 19  word_freq_credit            4601 non-null   float64
 20  word_freq_your              4601 non-null   float64
 21  word_freq_font              4601 non-null   float64
 22  word_freq_000               4601 non-null   float64
 23  word_freq_money             4601 non-null   float64
 24  word_freq_hp                4601 non-null   float64
 25  word_freq_hpl               4601 non-null   float64
 26  word_freq_george            4601 non-null   float64
 27  word_freq_650               4601 non-null   float64
 28  word_freq_lab               4601 non-null   float64
 29  word_freq_labs              4601 non-null   float64
 30  word_freq_telnet            4601 non-null   float64
 31  word_freq_857               4601 non-null   float64
 32  word_freq_data              4601 non-null   float64
 33  word_freq_415               4601 non-null   float64
 34  word_freq_85                4601 non-null   float64
 35  word_freq_technology        4601 non-null   float64
 36  word_freq_1999              4601 non-null   float64
 37  word_freq_parts             4601 non-null   float64
 38  word_freq_pm                4601 non-null   float64
 39  word_freq_direct            4601 non-null   float64
 40  word_freq_cs                4601 non-null   float64
 41  word_freq_meeting           4601 non-null   float64
 42  word_freq_original          4601 non-null   float64
 43  word_freq_project           4601 non-null   float64
 44  word_freq_re                4601 non-null   float64
 45  word_freq_edu               4601 non-null   float64
 46  word_freq_table             4601 non-null   float64
 47  word_freq_conference        4601 non-null   float64
 48  char_freq_;                 4601 non-null   float64
 49  char_freq_(                 4601 non-null   float64
 50  char_freq_[                 4601 non-null   float64
 51  char_freq_!                 4601 non-null   float64
 52  char_freq_$                 4601 non-null   float64
 53  char_freq_#                 4601 non-null   float64
 54  capital_run_length_average  4601 non-null   float64
 55  capital_run_length_longest  4601 non-null   int64  
 56  capital_run_length_total    4601 non-null   int64  
 57  Spam_fl                     4601 non-null   int64  
dtypes: float64(55), int64(3)
memory usage: 2.0 MB
None
   word_freq_make  word_freq_address  word_freq_all  word_freq_3d  \
0            0.00               0.64           0.64           0.0   
1            0.21               0.28           0.50           0.0   
2            0.06               0.00           0.71           0.0   
3            0.00               0.00           0.00           0.0   
4            0.00               0.00           0.00           0.0   
5            0.00               0.00           0.00           0.0   
6            0.00               0.00           0.00           0.0   
7            0.00               0.00           0.00           0.0   
8            0.15               0.00           0.46           0.0   
9            0.06               0.12           0.77           0.0   

   word_freq_our  word_freq_over  word_freq_remove  word_freq_internet  \
0           0.32            0.00              0.00                0.00   
1           0.14            0.28              0.21                0.07   
2           1.23            0.19              0.19                0.12   
3           0.63            0.00              0.31                0.63   
4           0.63            0.00              0.31                0.63   
5           1.85            0.00              0.00                1.85   
6           1.92            0.00              0.00                0.00   
7           1.88            0.00              0.00                1.88   
8           0.61            0.00              0.30                0.00   
9           0.19            0.32              0.38                0.00   

   word_freq_order  word_freq_mail  ...  char_freq_;  char_freq_(  \
0             0.00            0.00  ...         0.00        0.000   
1             0.00            0.94  ...         0.00        0.132   
2             0.64            0.25  ...         0.01        0.143   
3             0.31            0.63  ...         0.00        0.137   
4             0.31            0.63  ...         0.00        0.135   
5             0.00            0.00  ...         0.00        0.223   
6             0.00            0.64  ...         0.00        0.054   
7             0.00            0.00  ...         0.00        0.206   
8             0.92            0.76  ...         0.00        0.271   
9             0.06            0.00  ...         0.04        0.030   

   char_freq_[  char_freq_!  char_freq_$  char_freq_#  \
0          0.0        0.778        0.000        0.000   
1          0.0        0.372        0.180        0.048   
2          0.0        0.276        0.184        0.010   
3          0.0        0.137        0.000        0.000   
4          0.0        0.135        0.000        0.000   
5          0.0        0.000        0.000        0.000   
6          0.0        0.164        0.054        0.000   
7          0.0        0.000        0.000        0.000   
8          0.0        0.181        0.203        0.022   
9          0.0        0.244        0.081        0.000   

   capital_run_length_average  capital_run_length_longest  \
0                       3.756                          61   
1                       5.114                         101   
2                       9.821                         485   
3                       3.537                          40   
4                       3.537                          40   
5                       3.000                          15   
6                       1.671                           4   
7                       2.450                          11   
8                       9.744                         445   
9                       1.729                          43   

   capital_run_length_total  Spam_fl  
0                       278        1  
1                      1028        1  
2                      2259        1  
3                       191        1  
4                       191        1  
5                        54        1  
6                       112        1  
7                        49        1  
8                      1257        1  
9                       749        1  

[10 rows x 58 columns]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="modelling">
<h2>Modelling<a class="headerlink" href="#modelling" title="Permalink to this headline">¶</a></h2>
<p>This section:</p>
<ul class="simple">
<li><p>fits a model; and</p></li>
<li><p>evaluates the fitted model.</p></li>
</ul>
<div class="section" id="fit-model">
<h3>Fit model<a class="headerlink" href="#fit-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build a neural network to classify an email as spam or non-spam.</span>

<span class="c1"># Change the pandas dataframe to numpy arrays containing the features (X) and response(Y).</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">spam</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="c1"># Drops the last column of the dataframe that contains the spam indicator (response).</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">spam</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">57</span><span class="p">:</span><span class="mi">58</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Standardise the data so that each feature has mean 0 and standard deviation 1.</span>
<span class="n">sc</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Encode the response variable (&#39;not spam&#39; or &#39;spam&#39;) as 2 outcomes.</span>
<span class="n">ohe</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">()</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">ohe</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>

<span class="c1"># Split the data into train and test sets </span>
<span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">Y_train</span><span class="p">,</span><span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
                                <span class="c1"># This separates the data into training (75%) and test (25%) datasets.</span>

<span class="c1"># Build a neural network with two hidden layers, containing 28 hidden neurons</span>
<span class="c1"># (16 neurons in the first hidden layer and 12 neurons in the second hidden layer).</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="c1"># Create a hidden layer with 16 neurons, an input dimension of 57,</span>
<span class="c1"># representing the features of the dataset and a ReLU activation function.</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="mi">57</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">))</span>
<span class="c1"># Create a second hidden layer with 12 neurons and a ReLU activation function.</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">))</span>
<span class="c1"># Create the output layer with 2 neurons representing &#39;spam&#39; and &#39;not spam&#39;.</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">))</span>

<span class="c1"># Compile the model using the binary cross entropy loss function (logistic loss),</span>
<span class="c1"># the Adam optimiser (adaptive momentum estimation) which is an enhanced version</span>
<span class="c1"># of stochastic gradient descent (SGD), and capture the accuracy of model predictions.</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;binary_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>                                         

<span class="c1"># Fit the model.</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span><span class="n">validation_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">Y_test</span><span class="p">),</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/100
54/54 [==============================] - 1s 7ms/step - loss: 0.7130 - accuracy: 0.5933 - val_loss: 0.6341 - val_accuracy: 0.7507
Epoch 2/100
54/54 [==============================] - 0s 4ms/step - loss: 0.5768 - accuracy: 0.8310 - val_loss: 0.4987 - val_accuracy: 0.8610
Epoch 3/100
54/54 [==============================] - 0s 7ms/step - loss: 0.4230 - accuracy: 0.8826 - val_loss: 0.3495 - val_accuracy: 0.8923
Epoch 4/100
54/54 [==============================] - 0s 3ms/step - loss: 0.3092 - accuracy: 0.8991 - val_loss: 0.2717 - val_accuracy: 0.9079
Epoch 5/100
54/54 [==============================] - 0s 3ms/step - loss: 0.2585 - accuracy: 0.9145 - val_loss: 0.2361 - val_accuracy: 0.9209
Epoch 6/100
54/54 [==============================] - 0s 4ms/step - loss: 0.2323 - accuracy: 0.9214 - val_loss: 0.2137 - val_accuracy: 0.9305
Epoch 7/100
54/54 [==============================] - 0s 2ms/step - loss: 0.2157 - accuracy: 0.9255 - val_loss: 0.1992 - val_accuracy: 0.9357
Epoch 8/100
54/54 [==============================] - 0s 4ms/step - loss: 0.2034 - accuracy: 0.9307 - val_loss: 0.1902 - val_accuracy: 0.9383
Epoch 9/100
54/54 [==============================] - 0s 3ms/step - loss: 0.1939 - accuracy: 0.9322 - val_loss: 0.1815 - val_accuracy: 0.9401
Epoch 10/100
54/54 [==============================] - 0s 3ms/step - loss: 0.1866 - accuracy: 0.9319 - val_loss: 0.1767 - val_accuracy: 0.9392
Epoch 11/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1812 - accuracy: 0.9339 - val_loss: 0.1717 - val_accuracy: 0.9444
Epoch 12/100
54/54 [==============================] - 0s 4ms/step - loss: 0.1761 - accuracy: 0.9345 - val_loss: 0.1690 - val_accuracy: 0.9470
Epoch 13/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1724 - accuracy: 0.9351 - val_loss: 0.1663 - val_accuracy: 0.9435
Epoch 14/100
54/54 [==============================] - 0s 2ms/step - loss: 0.1689 - accuracy: 0.9351 - val_loss: 0.1615 - val_accuracy: 0.9479
Epoch 15/100
54/54 [==============================] - 0s 3ms/step - loss: 0.1654 - accuracy: 0.9371 - val_loss: 0.1595 - val_accuracy: 0.9461
Epoch 16/100
54/54 [==============================] - 0s 3ms/step - loss: 0.1622 - accuracy: 0.9386 - val_loss: 0.1584 - val_accuracy: 0.9435
Epoch 17/100
54/54 [==============================] - 0s 2ms/step - loss: 0.1598 - accuracy: 0.9388 - val_loss: 0.1553 - val_accuracy: 0.9479
Epoch 18/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1563 - accuracy: 0.9414 - val_loss: 0.1556 - val_accuracy: 0.9435
Epoch 19/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1544 - accuracy: 0.9414 - val_loss: 0.1531 - val_accuracy: 0.9453
Epoch 20/100
54/54 [==============================] - 0s 3ms/step - loss: 0.1515 - accuracy: 0.9446 - val_loss: 0.1533 - val_accuracy: 0.9435
Epoch 21/100
54/54 [==============================] - 0s 3ms/step - loss: 0.1496 - accuracy: 0.9449 - val_loss: 0.1488 - val_accuracy: 0.9470
Epoch 22/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1474 - accuracy: 0.9455 - val_loss: 0.1482 - val_accuracy: 0.9470
Epoch 23/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1451 - accuracy: 0.9443 - val_loss: 0.1479 - val_accuracy: 0.9453
Epoch 24/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1436 - accuracy: 0.9455 - val_loss: 0.1465 - val_accuracy: 0.9461
Epoch 25/100
54/54 [==============================] - 0s 2ms/step - loss: 0.1416 - accuracy: 0.9475 - val_loss: 0.1435 - val_accuracy: 0.9479
Epoch 26/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1401 - accuracy: 0.9470 - val_loss: 0.1425 - val_accuracy: 0.9487
Epoch 27/100
54/54 [==============================] - 0s 2ms/step - loss: 0.1378 - accuracy: 0.9484 - val_loss: 0.1408 - val_accuracy: 0.9487
Epoch 28/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1363 - accuracy: 0.9478 - val_loss: 0.1440 - val_accuracy: 0.9479
Epoch 29/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1341 - accuracy: 0.9513 - val_loss: 0.1403 - val_accuracy: 0.9479
Epoch 30/100
54/54 [==============================] - 0s 2ms/step - loss: 0.1331 - accuracy: 0.9507 - val_loss: 0.1395 - val_accuracy: 0.9487
Epoch 31/100
54/54 [==============================] - 0s 2ms/step - loss: 0.1314 - accuracy: 0.9510 - val_loss: 0.1403 - val_accuracy: 0.9487
Epoch 32/100
54/54 [==============================] - 0s 2ms/step - loss: 0.1297 - accuracy: 0.9516 - val_loss: 0.1387 - val_accuracy: 0.9496
Epoch 33/100
54/54 [==============================] - 0s 2ms/step - loss: 0.1295 - accuracy: 0.9516 - val_loss: 0.1377 - val_accuracy: 0.9487
Epoch 34/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1275 - accuracy: 0.9519 - val_loss: 0.1364 - val_accuracy: 0.9496
Epoch 35/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1260 - accuracy: 0.9542 - val_loss: 0.1345 - val_accuracy: 0.9496
Epoch 36/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1244 - accuracy: 0.9536 - val_loss: 0.1356 - val_accuracy: 0.9496
Epoch 37/100
54/54 [==============================] - 1s 12ms/step - loss: 0.1233 - accuracy: 0.9542 - val_loss: 0.1349 - val_accuracy: 0.9513
Epoch 38/100
54/54 [==============================] - 0s 5ms/step - loss: 0.1219 - accuracy: 0.9542 - val_loss: 0.1333 - val_accuracy: 0.9505
Epoch 39/100
54/54 [==============================] - 0s 4ms/step - loss: 0.1203 - accuracy: 0.9559 - val_loss: 0.1379 - val_accuracy: 0.9479
Epoch 40/100
54/54 [==============================] - 0s 4ms/step - loss: 0.1189 - accuracy: 0.9568 - val_loss: 0.1332 - val_accuracy: 0.9505
Epoch 41/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1187 - accuracy: 0.9588 - val_loss: 0.1325 - val_accuracy: 0.9496
Epoch 42/100
54/54 [==============================] - 0s 2ms/step - loss: 0.1164 - accuracy: 0.9577 - val_loss: 0.1330 - val_accuracy: 0.9513
Epoch 43/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1154 - accuracy: 0.9586 - val_loss: 0.1329 - val_accuracy: 0.9522
Epoch 44/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1139 - accuracy: 0.9591 - val_loss: 0.1317 - val_accuracy: 0.9513
Epoch 45/100
54/54 [==============================] - 0s 2ms/step - loss: 0.1127 - accuracy: 0.9583 - val_loss: 0.1324 - val_accuracy: 0.9513
Epoch 46/100
54/54 [==============================] - 0s 2ms/step - loss: 0.1124 - accuracy: 0.9609 - val_loss: 0.1321 - val_accuracy: 0.9496
Epoch 47/100
54/54 [==============================] - 0s 2ms/step - loss: 0.1123 - accuracy: 0.9606 - val_loss: 0.1301 - val_accuracy: 0.9531
Epoch 48/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1110 - accuracy: 0.9586 - val_loss: 0.1324 - val_accuracy: 0.9496
Epoch 49/100
54/54 [==============================] - 0s 2ms/step - loss: 0.1090 - accuracy: 0.9606 - val_loss: 0.1317 - val_accuracy: 0.9531
Epoch 50/100
54/54 [==============================] - 0s 2ms/step - loss: 0.1086 - accuracy: 0.9617 - val_loss: 0.1333 - val_accuracy: 0.9496
Epoch 51/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1070 - accuracy: 0.9620 - val_loss: 0.1329 - val_accuracy: 0.9487
Epoch 52/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1060 - accuracy: 0.9620 - val_loss: 0.1339 - val_accuracy: 0.9487
Epoch 53/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1052 - accuracy: 0.9638 - val_loss: 0.1348 - val_accuracy: 0.9505
Epoch 54/100
54/54 [==============================] - 0s 3ms/step - loss: 0.1042 - accuracy: 0.9614 - val_loss: 0.1341 - val_accuracy: 0.9470
Epoch 55/100
54/54 [==============================] - 0s 4ms/step - loss: 0.1035 - accuracy: 0.9623 - val_loss: 0.1319 - val_accuracy: 0.9522
Epoch 56/100
54/54 [==============================] - 0s 4ms/step - loss: 0.1044 - accuracy: 0.9635 - val_loss: 0.1307 - val_accuracy: 0.9548
Epoch 57/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1011 - accuracy: 0.9646 - val_loss: 0.1331 - val_accuracy: 0.9505
Epoch 58/100
54/54 [==============================] - 0s 1ms/step - loss: 0.1010 - accuracy: 0.9629 - val_loss: 0.1317 - val_accuracy: 0.9522
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 59/100
54/54 [==============================] - 0s 3ms/step - loss: 0.1000 - accuracy: 0.9641 - val_loss: 0.1302 - val_accuracy: 0.9522
Epoch 60/100
54/54 [==============================] - 0s 2ms/step - loss: 0.0989 - accuracy: 0.9649 - val_loss: 0.1312 - val_accuracy: 0.9513
Epoch 61/100
54/54 [==============================] - 0s 1ms/step - loss: 0.0982 - accuracy: 0.9661 - val_loss: 0.1321 - val_accuracy: 0.9522
Epoch 62/100
54/54 [==============================] - 0s 1ms/step - loss: 0.0975 - accuracy: 0.9652 - val_loss: 0.1326 - val_accuracy: 0.9513
Epoch 63/100
54/54 [==============================] - 0s 1ms/step - loss: 0.0968 - accuracy: 0.9661 - val_loss: 0.1310 - val_accuracy: 0.9531
Epoch 64/100
54/54 [==============================] - 0s 1ms/step - loss: 0.0967 - accuracy: 0.9661 - val_loss: 0.1318 - val_accuracy: 0.9513
Epoch 65/100
54/54 [==============================] - 0s 1ms/step - loss: 0.0959 - accuracy: 0.9664 - val_loss: 0.1344 - val_accuracy: 0.9487
Epoch 66/100
54/54 [==============================] - 0s 1ms/step - loss: 0.0958 - accuracy: 0.9658 - val_loss: 0.1338 - val_accuracy: 0.9496
Epoch 67/100
54/54 [==============================] - 0s 1ms/step - loss: 0.0944 - accuracy: 0.9661 - val_loss: 0.1346 - val_accuracy: 0.9487
Epoch 68/100
54/54 [==============================] - 0s 1ms/step - loss: 0.0932 - accuracy: 0.9670 - val_loss: 0.1339 - val_accuracy: 0.9487
Epoch 69/100
54/54 [==============================] - 0s 1ms/step - loss: 0.0929 - accuracy: 0.9670 - val_loss: 0.1305 - val_accuracy: 0.9531
Epoch 70/100
54/54 [==============================] - 0s 1ms/step - loss: 0.0922 - accuracy: 0.9658 - val_loss: 0.1337 - val_accuracy: 0.9487
Epoch 71/100
54/54 [==============================] - 0s 1ms/step - loss: 0.0917 - accuracy: 0.9675 - val_loss: 0.1312 - val_accuracy: 0.9522
Epoch 72/100
54/54 [==============================] - 0s 2ms/step - loss: 0.0909 - accuracy: 0.9672 - val_loss: 0.1345 - val_accuracy: 0.9496
Epoch 73/100
54/54 [==============================] - 0s 5ms/step - loss: 0.0902 - accuracy: 0.9672 - val_loss: 0.1350 - val_accuracy: 0.9505
Epoch 74/100
54/54 [==============================] - 0s 3ms/step - loss: 0.0896 - accuracy: 0.9672 - val_loss: 0.1337 - val_accuracy: 0.9513
Epoch 75/100
54/54 [==============================] - 0s 1ms/step - loss: 0.0886 - accuracy: 0.9672 - val_loss: 0.1334 - val_accuracy: 0.9540
Epoch 76/100
54/54 [==============================] - 0s 3ms/step - loss: 0.0882 - accuracy: 0.9687 - val_loss: 0.1370 - val_accuracy: 0.9487
Epoch 77/100
54/54 [==============================] - 0s 1ms/step - loss: 0.0880 - accuracy: 0.9690 - val_loss: 0.1359 - val_accuracy: 0.9522
Epoch 78/100
54/54 [==============================] - 0s 2ms/step - loss: 0.0873 - accuracy: 0.9678 - val_loss: 0.1387 - val_accuracy: 0.9479
Epoch 79/100
54/54 [==============================] - 0s 3ms/step - loss: 0.0873 - accuracy: 0.9690 - val_loss: 0.1340 - val_accuracy: 0.9522
Epoch 80/100
54/54 [==============================] - 0s 3ms/step - loss: 0.0859 - accuracy: 0.9681 - val_loss: 0.1334 - val_accuracy: 0.9540
Epoch 81/100
54/54 [==============================] - 0s 3ms/step - loss: 0.0856 - accuracy: 0.9696 - val_loss: 0.1374 - val_accuracy: 0.9505
Epoch 82/100
54/54 [==============================] - 0s 4ms/step - loss: 0.0855 - accuracy: 0.9704 - val_loss: 0.1357 - val_accuracy: 0.9522
Epoch 83/100
54/54 [==============================] - 0s 2ms/step - loss: 0.0848 - accuracy: 0.9696 - val_loss: 0.1343 - val_accuracy: 0.9531
Epoch 84/100
54/54 [==============================] - 0s 3ms/step - loss: 0.0835 - accuracy: 0.9699 - val_loss: 0.1380 - val_accuracy: 0.9522
Epoch 85/100
54/54 [==============================] - 0s 5ms/step - loss: 0.0830 - accuracy: 0.9699 - val_loss: 0.1358 - val_accuracy: 0.9540
Epoch 86/100
54/54 [==============================] - 0s 3ms/step - loss: 0.0831 - accuracy: 0.9699 - val_loss: 0.1377 - val_accuracy: 0.9513
Epoch 87/100
54/54 [==============================] - 0s 1ms/step - loss: 0.0817 - accuracy: 0.9710 - val_loss: 0.1369 - val_accuracy: 0.9522
Epoch 88/100
54/54 [==============================] - 0s 2ms/step - loss: 0.0810 - accuracy: 0.9722 - val_loss: 0.1383 - val_accuracy: 0.9557
Epoch 89/100
54/54 [==============================] - 0s 5ms/step - loss: 0.0815 - accuracy: 0.9704 - val_loss: 0.1362 - val_accuracy: 0.9548
Epoch 90/100
54/54 [==============================] - 0s 2ms/step - loss: 0.0801 - accuracy: 0.9722 - val_loss: 0.1407 - val_accuracy: 0.9522
Epoch 91/100
54/54 [==============================] - 0s 4ms/step - loss: 0.0798 - accuracy: 0.9716 - val_loss: 0.1417 - val_accuracy: 0.9513: 0s - loss: 0.0746 - accuracy: 0.97
Epoch 92/100
54/54 [==============================] - 0s 2ms/step - loss: 0.0796 - accuracy: 0.9707 - val_loss: 0.1374 - val_accuracy: 0.9540
Epoch 93/100
54/54 [==============================] - 0s 2ms/step - loss: 0.0786 - accuracy: 0.9716 - val_loss: 0.1398 - val_accuracy: 0.9548
Epoch 94/100
54/54 [==============================] - 0s 3ms/step - loss: 0.0780 - accuracy: 0.9722 - val_loss: 0.1422 - val_accuracy: 0.9513
Epoch 95/100
54/54 [==============================] - 0s 4ms/step - loss: 0.0776 - accuracy: 0.9730 - val_loss: 0.1419 - val_accuracy: 0.9531
Epoch 96/100
54/54 [==============================] - 0s 3ms/step - loss: 0.0770 - accuracy: 0.9736 - val_loss: 0.1437 - val_accuracy: 0.9522
Epoch 97/100
54/54 [==============================] - 0s 1ms/step - loss: 0.0763 - accuracy: 0.9742 - val_loss: 0.1409 - val_accuracy: 0.9548
Epoch 98/100
54/54 [==============================] - 0s 1ms/step - loss: 0.0762 - accuracy: 0.9730 - val_loss: 0.1415 - val_accuracy: 0.9566
Epoch 99/100
54/54 [==============================] - 0s 2ms/step - loss: 0.0766 - accuracy: 0.9736 - val_loss: 0.1462 - val_accuracy: 0.9505
Epoch 100/100
54/54 [==============================] - 0s 2ms/step - loss: 0.0758 - accuracy: 0.9757 - val_loss: 0.1436 - val_accuracy: 0.9557
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="evaluate-model">
<h3>Evaluate model<a class="headerlink" href="#evaluate-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the accuracy of the fitted model on the training and test data.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_accuracy&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Model accuracy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Accuracy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Epoch&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Train&#39;</span><span class="p">,</span> <span class="s1">&#39;Test&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/DAA_M05_Ex18_12_0.png" src="../_images/DAA_M05_Ex18_12_0.png" />
</div>
</div>
<p>The plot of the model’s accuracy against the number of epochs suggests that accuracy on the test data does not improve much beyond approximately 10 epochs (cycles through the full dataset).</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "ActuariesInstitute/cookbook",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="DAA_M05_Ex10.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Py: Decision Tree Classification</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="DAA_M07_CS1.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Py: Classifying review sentiment</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By YDAWG, DAPC, YAC and other contributors.<br/>
    
      <div class="extra_footer">
         The Actuaries' Analytical Cookbook is a series of data and analytics recipes to help actuaries quickly get started with a new project.   This site is intended to be a resource to actuaries in both data science and traditional fields.  Opinions expressed in this publication are the opinions of contributors and do not necessarily represent those of either the Institute of Actuaries of Australia (the ‘Institute’), its members, directors, officers, employees, agents, or that of the employers of the contributors. <br>© Institute of Actuaries of Australia and Contributors 2021. All rights reserved.
      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>